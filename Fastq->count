#1.查看数据质量
 #FastQC
fastqc -t 6 -o out_path sample1_1.fq sample1_2.fq #conda运行，
 #-o --outdir:输出路径；--extract：结果文件解压缩；--noextract：结果文件压缩；-f --format:输入文件格式.支持bam,sam,fastq文件格式；-t --threads:线程数；-c --contaminants：制定污染序列，文件格式 name[tab]sequence；
 #-a --adapters：指定接头序列，文件格式name[tab]sequence；-k --kmers：指定kmers长度（2-10bp,默认7bp）；-q --quiet：安静模式

#2.去接头和低质量序列（忽略）

#3.再次查看数据质量（忽略）

#4.读取并比对（STAR；如果使用hisat2进行比对会生成SAM文件）
 #构建基因组索引，运行的star和构建索引的star版本要保持一致
STAR --runThreadN 25 --runMode genomeGenerate 
     --genomeDir /mnt/raid5/User/bailin/project/240701SDUTCM.DiabeticFeet/250107/STAR/index 
     --genomeFastaFiles /mnt/raid5/User/bailin/Document_of_match_and_annotation/Fastq/genomeFastaFiles/Homo_sapiens.GRCh38.fa 
     --sjdbGTFfile /mnt/raid5/User/bailin/Document_of_match_and_annotation/Fastq/sjdbGTFfile/Homo_sapiens.GRCh38.113.gtf 
     --sjdbOverhang 149
 #--runThreadN：线程数；--runMode genomeGenerate：构建基因组索引；--genomeDir：索引目录。（index_dir一定要是存在的文件夹，需提前建好）；--genomeFastaFiles：基因组文件；--sjdbGTFfile：基因组注释文件；--sjdbOverhang：reads长度减1。
 #进行read比对
STAR --twopassMode Basic --quantMode TranscriptomeSAM GeneCounts 
     --runThreadN 25 --genomeDir index_dir --alignIntronMin 20 --alignIntronMax 50000 
     --outSAMtype BAM SortedByCoordinate --sjdbOverhang 149 
     --outSAMattrRGline ID:sample SM:sample PL:ILLUMINA --outFilterMismatchNmax 2 
     --outSJfilterReads Unique --outSAMmultNmax 1 --outFileNamePrefix out_prefix 
     --outSAMmapqUnique 60 --readFilesCommand gunzip -c 
     --readFilesIn seq1.fq.gz seq2.fq.gz
 #--twopassMode Basic：使用two-pass模式进行reads比对。简单来说就是先按索引进行第一次比对，而后把第一次比对发现的新剪切位点信息加入到索引中进行第二次比对；--quantMode TranscriptomeSAM GeneCounts：将reads比对至转录本序列；--runThreadN：线程数；--genomeDir：索引目录；
 #--alignIntronMin：最短的内含子长度。（根据GTF文件计算）；--alignIntronMax：最长的内含子长度。（根据GTF文件计算）；--outSAMtype BAM SortedByCoordinate：输出BAM文件并进行排序；--sjdbOverhang：reads长度减1；--outSAMattrRGline：ID代表样本ID，SM代表样本名称，PL为测序平台。在使用GATK进行SNP Calling时同一SM的样本可以合并在一起；
 #--outFilterMismatchNmax：比对时允许的最大错配数；--outSJfilterReads Unique：对于跨越剪切位点的reads（junction reads)，只考虑跨越唯一剪切位点的reads；--outSAMmultNmax：每条reads输出比对结果的数量；--outFileNamePrefix：输出文件前缀；--outSAMmapqUnique 60：将uniquely mapping reads的MAPQ值调整为60，满足下游使用GATK进行分析的需要；
 #--readFilesCommand：对FASTQ文件进行操作；--readFilesIn：输入FASTQ文件的路径。

#5.查看比对后的BAM文件（samtools-也可以将SAM文件转换为BAM文件）
samtools view CK-1_Aligned.sortedByCoord.out.bam |head -n 5

#6.BAM转化为count文件（R：featureCounts）
